(function(){var url=window.PardotBaseUrl,arr=url.split("/");domain=arr[0]+"//"+arr[2];var pdSelectBuild=function(data,obj,module){var vals;function highlightActive(){var dialog=obj.getDialog(),urlField=dialog.getContentElement("info","txtUrl");if(urlField!==""){var setH=dialog.getContentElement("info","txtHeight").getValue();var setW=dialog.getContentElement("info","txtWidth").getValue();var urlFieldVal=urlField.getValue();var imageSelect=dialog.getContentElement("info","uploadedImage");var found=jQuery(imageSelect.getInputElement().$).find('option[value="'+urlFieldVal+'"]').length;if(found){obj.setValue(urlFieldVal);jQuery(".ImagePreviewLoader").hide()}}}function parseData(vals){if(vals.length){obj.add("Custom URL","");for(var i=0;i<vals.length;i++){var url=vals[i].url,name=vals[i].name;obj.add(name,url)}highlightActive()}}jQuery.ajax({url:domain+"/file/getSalesEdgeImageList",cache:false,success:function(d){if(d){obj.clear();d=eval(d);vals=d;parseData(vals)}},error:function(xhr,errorText,thrownError){console.log(xhr.statusText)}},"json")};var imageDialog=function(editor,dialogType){var IMAGE=1,LINK=2,PREVIEW=4,CLEANUP=8,regexGetSize=/^\s*(\d+)((px)|\%)?\s*$/i,regexGetSizeOrEmpty=/(^\s*(\d+)((px)|\%)?\s*$)|^$/i,pxLengthRegex=/^\d+px$/;var onSizeChange=function(){var value=this.getValue(),dialog=this.getDialog(),aMatch=value.match(regexGetSize);if(aMatch){if(aMatch[2]=="%"){switchLockRatio(dialog,false)}value=aMatch[1]}if(dialog.lockRatio){var oImageOriginal=dialog.originalElement;if(oImageOriginal.getCustomData("isReady")=="true"){if(this.id=="txtHeight"){if(value&&value!="0"){value=Math.round(oImageOriginal.$.width*(value/oImageOriginal.$.height))}if(!isNaN(value)){dialog.setValueOf("info","txtWidth",value)}}else{if(value&&value!="0"){value=Math.round(oImageOriginal.$.height*(value/oImageOriginal.$.width))}if(!isNaN(value)){dialog.setValueOf("info","txtHeight",value)}}}}updatePreview(dialog)};var updatePreview=function(dialog){if(!dialog.originalElement||!dialog.preview){return 1}dialog.commitContent(PREVIEW,dialog.preview);return 0};function commitContent(){var args=arguments;var inlineStyleField=this.getContentElement("advanced","txtdlgGenStyle");inlineStyleField&&inlineStyleField.commit.apply(inlineStyleField,args);this.foreach(function(widget){if(widget.commit&&widget.id!="txtdlgGenStyle"){widget.commit.apply(widget,args)}})}var incommit;function commitInternally(targetFields){if(incommit){return}incommit=1;var dialog=this.getDialog(),element=dialog.imageElement;if(element){this.commit(IMAGE,element);targetFields=[].concat(targetFields);var length=targetFields.length,field;for(var i=0;i<length;i++){field=dialog.getContentElement.apply(dialog,targetFields[i].split(":"));field&&field.setup(IMAGE,element)}}incommit=0}var switchLockRatio=function(dialog,value){if(!dialog.getContentElement("info","ratioLock")){return null}var oImageOriginal=dialog.originalElement;if(!oImageOriginal){return null}if(value=="check"){if(!dialog.userlockRatio&&oImageOriginal.getCustomData("isReady")=="true"){var width=dialog.getValueOf("info","txtWidth"),height=dialog.getValueOf("info","txtHeight"),originalRatio=oImageOriginal.$.width*1000/oImageOriginal.$.height,thisRatio=width*1000/height;dialog.lockRatio=false;if(!width&&!height){dialog.lockRatio=true}else{if(!isNaN(originalRatio)&&!isNaN(thisRatio)){if(Math.round(originalRatio)==Math.round(thisRatio)){dialog.lockRatio=true}}}}}else{if(value!=undefined){dialog.lockRatio=value}else{dialog.userlockRatio=1;dialog.lockRatio=!dialog.lockRatio}}var ratioButton=CKEDITOR.document.getById(btnLockSizesId);if(dialog.lockRatio){ratioButton.removeClass("cke_btn_unlocked")}else{ratioButton.addClass("cke_btn_unlocked")}ratioButton.setAttribute("aria-checked",dialog.lockRatio);if(CKEDITOR.env.hc){var icon=ratioButton.getChild(0);icon.setHtml(dialog.lockRatio?CKEDITOR.env.ie?"\u25A0":"\u25A3":CKEDITOR.env.ie?"\u25A1":"\u25A2")}return dialog.lockRatio};var resetSize=function(dialog){var oImageOriginal=dialog.originalElement;if(oImageOriginal.getCustomData("isReady")=="true"){var widthField=dialog.getContentElement("info","txtWidth"),heightField=dialog.getContentElement("info","txtHeight");widthField&&widthField.setValue(oImageOriginal.$.width);heightField&&heightField.setValue(oImageOriginal.$.height)}updatePreview(dialog)};var setupDimension=function(type,element){if(type!=IMAGE){return}function checkDimension(size,defaultValue){var aMatch=size.match(regexGetSize);if(aMatch){if(aMatch[2]=="%"){aMatch[1]+="%";switchLockRatio(dialog,false)}return aMatch[1]}return defaultValue}var dialog=this.getDialog(),value="",dimension=this.id=="txtWidth"?"width":"height",size=element.getAttribute(dimension);if(size){value=checkDimension(size,value)}value=checkDimension(element.getStyle(dimension),value);this.setValue(value)};var previewPreloader;var onImgLoadEvent=function(){var original=this.originalElement;original.setCustomData("isReady","true");original.removeListener("load",onImgLoadEvent);original.removeListener("error",onImgLoadErrorEvent);original.removeListener("abort",onImgLoadErrorEvent);CKEDITOR.document.getById(imagePreviewLoaderId).setStyle("display","none");if(!this.dontResetSize){resetSize(this)}if(this.firstLoad){CKEDITOR.tools.setTimeout(function(){switchLockRatio(this,"check")},0,this)}this.firstLoad=false;this.dontResetSize=false};var onImgLoadErrorEvent=function(){var original=this.originalElement;original.removeListener("load",onImgLoadEvent);original.removeListener("error",onImgLoadErrorEvent);original.removeListener("abort",onImgLoadErrorEvent);var noimage=CKEDITOR.getUrl(CKEDITOR.plugins.get("image").path+"images/noimage.png");if(this.preview){this.preview.setAttribute("src",noimage)}CKEDITOR.document.getById(imagePreviewLoaderId).setStyle("display","none");switchLockRatio(this,false)};var numbering=function(id){return CKEDITOR.tools.getNextId()+"_"+id},btnLockSizesId=numbering("btnLockSizes"),btnResetSizeId=numbering("btnResetSize"),imagePreviewLoaderId=numbering("ImagePreviewLoader"),previewLinkId=numbering("previewLink"),previewImageId=numbering("previewImage");return{title:editor.lang.image[dialogType=="image"?"title":"titleButton"],minWidth:700,minHeight:320,onShow:function(){this.imageElement=false;this.linkElement=false;this.imageEditMode=false;this.linkEditMode=false;this.lockRatio=true;this.userlockRatio=0;this.dontResetSize=false;this.firstLoad=true;this.addLink=false;var editor=this.getParentEditor(),sel=editor.getSelection(),element=sel&&sel.getSelectedElement(),link=element&&editor.elementPath(element).contains("a",1);CKEDITOR.document.getById(imagePreviewLoaderId).setStyle("display","none");previewPreloader=new CKEDITOR.dom.element("img",editor.document);this.preview=CKEDITOR.document.getById(previewImageId);this.originalElement=editor.document.createElement("img");this.originalElement.setAttribute("alt","");this.originalElement.setCustomData("isReady","false");if(link){this.linkElement=link;this.linkEditMode=true;var linkChildren=link.getChildren();if(linkChildren.count()==1){var childTagName=linkChildren.getItem(0).getName();if(childTagName=="img"||childTagName=="input"){this.imageElement=linkChildren.getItem(0);if(this.imageElement.getName()=="img"){this.imageEditMode="img"}else{if(this.imageElement.getName()=="input"){this.imageEditMode="input"}}}}if(dialogType=="image"){this.setupContent(LINK,link)}}if(element&&element.getName()=="img"&&!element.data("cke-realelement")||element&&element.getName()=="input"&&element.getAttribute("type")=="image"){this.imageEditMode=element.getName();this.imageElement=element}if(this.imageEditMode){this.cleanImageElement=this.imageElement;this.imageElement=this.cleanImageElement.clone(true,true);this.setupContent(IMAGE,this.imageElement)}else{this.imageElement=editor.document.createElement("img")}switchLockRatio(this,true);if(!CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))){this.preview.removeAttribute("src");this.preview.setStyle("display","none")}},onOk:function(){if(this.imageEditMode){var imgTagName=this.imageEditMode;if(dialogType=="image"&&imgTagName=="input"&&confirm(editor.lang.image.button2Img)){imgTagName="img";this.imageElement=editor.document.createElement("img");this.imageElement.setAttribute("alt","");editor.insertElement(this.imageElement)}else{if(dialogType!="image"&&imgTagName=="img"&&confirm(editor.lang.image.img2Button)){imgTagName="input";this.imageElement=editor.document.createElement("input");this.imageElement.setAttributes({type:"image",alt:""});editor.insertElement(this.imageElement)}else{this.imageElement=this.cleanImageElement;delete this.cleanImageElement}}}else{if(dialogType=="image"){this.imageElement=editor.document.createElement("img")}else{this.imageElement=editor.document.createElement("input");this.imageElement.setAttribute("type","image")}this.imageElement.setAttribute("alt","")}if(!this.linkEditMode){this.linkElement=editor.document.createElement("a")}this.commitContent(IMAGE,this.imageElement);this.commitContent(LINK,this.linkElement);if(!this.imageElement.getAttribute("style")){this.imageElement.removeAttribute("style")}if(!this.imageEditMode){if(this.addLink){if(!this.linkEditMode){editor.insertElement(this.linkElement);this.linkElement.append(this.imageElement,false)}else{editor.insertElement(this.imageElement)}}else{editor.insertElement(this.imageElement)}}else{if(!this.linkEditMode&&this.addLink){editor.insertElement(this.linkElement);this.imageElement.appendTo(this.linkElement)}else{if(this.linkEditMode&&!this.addLink){editor.getSelection().selectElement(this.linkElement);editor.insertElement(this.imageElement)}}}},onLoad:function(){if(dialogType!="image"){this.hidePage("Link")}var doc=this._.element.getDocument();if(this.getContentElement("info","ratioLock")){this.addFocusable(doc.getById(btnResetSizeId),5);this.addFocusable(doc.getById(btnLockSizesId),5)}this.commitContent=commitContent},onHide:function(){if(this.preview){this.commitContent(CLEANUP,this.preview)}if(this.originalElement){this.originalElement.removeListener("load",onImgLoadEvent);this.originalElement.removeListener("error",onImgLoadErrorEvent);this.originalElement.removeListener("abort",onImgLoadErrorEvent);this.originalElement.remove();this.originalElement=false}delete this.imageElement},contents:[{id:"info",label:editor.lang.image.infoTab,accessKey:"I",elements:[{type:"hbox",widths:["55%","45%"],children:[{type:"vbox",children:[{id:"uploadedImage",type:"select",label:"Image",required:true,style:"width:100%",items:[["Loading",""]],onShow:function(data){pdSelectBuild(data,this,"file")},onChange:function(){var newVal=this.getValue(),dialog=this.getDialog(),urlField=dialog.getContentElement("info","txtUrl");if(urlField.getValue()!==newVal){dialog.setValueOf("info","txtUrl",newVal)}urlField=urlField.getElement();if(newVal!==""){urlField.hide()}else{urlField.show()}}},{id:"txtUrl",type:"text",label:editor.lang.common.url,required:true,onChange:function(){var dialog=this.getDialog(),newUrl=this.getValue();if(newUrl.length>0){dialog=this.getDialog();var original=dialog.originalElement;dialog.preview.removeStyle("display");original.setCustomData("isReady","false");var loader=CKEDITOR.document.getById(imagePreviewLoaderId);if(loader){loader.setStyle("display","")}original.on("load",onImgLoadEvent,dialog);original.on("error",onImgLoadErrorEvent,dialog);original.on("abort",onImgLoadErrorEvent,dialog);original.setAttribute("src",newUrl);previewPreloader.setAttribute("src",newUrl);dialog.preview.setAttribute("src",previewPreloader.$.src);updatePreview(dialog)}else{if(dialog.preview){dialog.preview.removeAttribute("src");dialog.preview.setStyle("display","none")}}},setup:function(type,element){if(type==IMAGE){var url=element.data("cke-saved-src")||element.getAttribute("src");var field=this;this.getDialog().dontResetSize=true;field.setValue(url);field.setInitValue()}},commit:function(type,element){if(type==IMAGE&&(this.getValue()||this.isChanged())){element.data("cke-saved-src",this.getValue());element.setAttribute("src",this.getValue())}else{if(type==CLEANUP){element.setAttribute("src","");element.removeAttribute("src")}}},validate:CKEDITOR.dialog.validate.notEmpty(editor.lang.image.urlMissing)},{id:"txtAlt",type:"text",label:editor.lang.image.alt,accessKey:"T","default":"",onChange:function(){updatePreview(this.getDialog())},setup:function(type,element){if(type==IMAGE){this.setValue(element.getAttribute("alt"))}},commit:function(type,element){if(type==IMAGE){if(this.getValue()||this.isChanged()){element.setAttribute("alt",this.getValue())}}else{if(type==PREVIEW){element.setAttribute("alt",this.getValue())}else{if(type==CLEANUP){element.removeAttribute("alt")}}}}},{id:"basic",type:"vbox",children:[{type:"hbox",requiredContent:"img{width,height}",widths:["45%","11%","45%"],children:[{type:"text",id:"txtWidth",label:editor.lang.common.width,onKeyUp:onSizeChange,onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:function(){var aMatch=this.getValue().match(regexGetSizeOrEmpty),isValid=!!(aMatch&&parseInt(aMatch[1],10)!==0);if(!isValid){alert(editor.lang.common.invalidWidth)}return isValid},setup:setupDimension,commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE){if(value){element.setStyle("width",CKEDITOR.tools.cssLength(value));element.setAttribute("width",parseInt(CKEDITOR.tools.cssLength(value)))}else{element.removeAttribute("width");element.removeStyle("width")}!internalCommit}else{if(type==PREVIEW){var aMatch=value.match(regexGetSize);if(!aMatch){var oImageOriginal=this.getDialog().originalElement;if(oImageOriginal.getCustomData("isReady")=="true"){element.setStyle("width",oImageOriginal.$.width+"px")}}else{element.setStyle("width",CKEDITOR.tools.cssLength(value))}}else{if(type==CLEANUP){element.removeAttribute("width");element.removeStyle("width")}}}}},{id:"ratioLock",type:"html",style:"margin-top:15px;",onLoad:function(){var resetButton=CKEDITOR.document.getById(btnResetSizeId),ratioButton=CKEDITOR.document.getById(btnLockSizesId);if(resetButton){resetButton.on("click",function(evt){resetSize(this);evt.data&&evt.data.preventDefault()},this.getDialog());resetButton.on("mouseover",function(){this.addClass("cke_btn_over")},resetButton);resetButton.on("mouseout",function(){this.removeClass("cke_btn_over")},resetButton)}if(ratioButton){ratioButton.on("click",function(evt){var locked=switchLockRatio(this),oImageOriginal=this.originalElement,width=this.getValueOf("info","txtWidth");if(oImageOriginal.getCustomData("isReady")=="true"&&width){var height=oImageOriginal.$.height/oImageOriginal.$.width*width;if(!isNaN(height)){this.setValueOf("info","txtHeight",Math.round(height));updatePreview(this)}}evt.data&&evt.data.preventDefault()},this.getDialog());ratioButton.on("mouseover",function(){this.addClass("cke_btn_over")},ratioButton);ratioButton.on("mouseout",function(){this.removeClass("cke_btn_over")},ratioButton)}},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+editor.lang.image.lockRatio+'" class="cke_btn_locked" id="'+btnLockSizesId+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+editor.lang.image.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+editor.lang.image.resetSize+'" class="cke_btn_reset" id="'+btnResetSizeId+'" role="button"><span class="cke_label">'+editor.lang.image.resetSize+"</span></a></div>"},{type:"text",id:"txtHeight",label:editor.lang.common.height,onKeyUp:onSizeChange,onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:function(){var aMatch=this.getValue().match(regexGetSizeOrEmpty),isValid=!!(aMatch&&parseInt(aMatch[1],10)!==0);if(!isValid){alert(editor.lang.common.invalidHeight)}return isValid},setup:setupDimension,commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE){if(value){element.setAttribute("height",parseInt(CKEDITOR.tools.cssLength(value)));element.setStyle("height",CKEDITOR.tools.cssLength(value))}else{element.removeAttribute("height");element.removeStyle("height")}!internalCommit}else{if(type==PREVIEW){var aMatch=value.match(regexGetSize);if(!aMatch){var oImageOriginal=this.getDialog().originalElement;if(oImageOriginal.getCustomData("isReady")=="true"){element.setStyle("height",oImageOriginal.$.height+"px")}}else{element.setStyle("height",CKEDITOR.tools.cssLength(value))}}else{if(type==CLEANUP){element.removeAttribute("height");element.removeStyle("height")}}}}}]},{type:"hbox",widths:["25%","25%","25%","25%"],children:[{type:"text",id:"txtBorder",requiredContent:"img{border-width}",label:editor.lang.image.border,style:"width:88px","default":"0",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateBorder),setup:function(type,element){if(type==IMAGE){var value,borderStyle=element.getStyle("border-width");borderStyle=borderStyle&&borderStyle.match(/^(\d+px)(?: \1 \1 \1)?$/);value=borderStyle&&parseInt(borderStyle[1],10);isNaN(parseInt(value,10))&&(value=element.getAttribute("border"));this.setValue(value);if(value===0){this.setValue("0")}}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);if(type==IMAGE||type==PREVIEW){if(!isNaN(value)){element.setStyle("border-width",CKEDITOR.tools.cssLength(value));element.setStyle("border-style","solid");element.setAttribute("border",value)}else{if(!value&&this.isChanged()){element.removeAttribute("border");element.removeStyle("border")}}}else{if(type==CLEANUP){element.removeAttribute("border");element.removeStyle("border-width");element.removeStyle("border-style");element.removeStyle("border-color")}}}},{id:"cmbAlign",requiredContent:"img{float}",type:"select",style:"width:88px",label:editor.lang.common.align,"default":"",items:[[editor.lang.common.notSet,""],[editor.lang.common.alignLeft,"left"],[editor.lang.common.alignRight,"right"]],onChange:function(){updatePreview(this.getDialog());commitInternally.call(this,"advanced:txtdlgGenStyle")},setup:function(type,element){if(type==IMAGE){var value=element.getStyle("float");switch(value){case"inherit":case"none":value=""}!value&&(value=(element.getAttribute("align")||"").toLowerCase());this.setValue(value)}},commit:function(type,element,internalCommit){var value=this.getValue();if(type==IMAGE||type==PREVIEW){if(value){element.setStyle("float",value);element.setAttribute("align",value)}else{element.removeStyle("float");var currentAlign=(element.getAttribute("align")||"").toLowerCase();switch(currentAlign){case"left":case"right":element.removeAttribute("align")}}}else{if(type==CLEANUP){element.removeStyle("float")}}}},{type:"text",id:"txtHSpace",requiredContent:"img{margin-left,margin-right}",label:editor.lang.image.hSpace,style:"width:88px","default":"",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateHSpace),setup:function(type,element){if(type==IMAGE){var value,marginLeftPx,marginRightPx,marginLeftStyle=element.getStyle("margin-left"),marginRightStyle=element.getStyle("margin-right");marginLeftStyle=marginLeftStyle&&marginLeftStyle.match(pxLengthRegex);marginRightStyle=marginRightStyle&&marginRightStyle.match(pxLengthRegex);marginLeftPx=parseInt(marginLeftStyle,10);marginRightPx=parseInt(marginRightStyle,10);value=(marginLeftPx==marginRightPx)&&marginLeftPx;isNaN(parseInt(value,10))&&(value=element.getAttribute("hspace"));this.setValue(value)}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);if(type==IMAGE||type==PREVIEW){if(!isNaN(value)){element.setStyle("margin-left",CKEDITOR.tools.cssLength(value));element.setStyle("margin-right",CKEDITOR.tools.cssLength(value))}else{if(!value&&this.isChanged()){element.removeStyle("margin-left");element.removeStyle("margin-right")}}if(!internalCommit&&type==IMAGE){element.removeAttribute("hspace")}}else{if(type==CLEANUP){element.removeAttribute("hspace");element.removeStyle("margin-left");element.removeStyle("margin-right")}}}},{type:"text",id:"txtVSpace",style:"width:88px",requiredContent:"img{margin-top,margin-bottom}",label:editor.lang.image.vSpace,"default":"",onKeyUp:function(){updatePreview(this.getDialog())},onChange:function(){commitInternally.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(editor.lang.image.validateVSpace),setup:function(type,element){if(type==IMAGE){var value,marginTopPx,marginBottomPx,marginTopStyle=element.getStyle("margin-top"),marginBottomStyle=element.getStyle("margin-bottom");marginTopStyle=marginTopStyle&&marginTopStyle.match(pxLengthRegex);marginBottomStyle=marginBottomStyle&&marginBottomStyle.match(pxLengthRegex);marginTopPx=parseInt(marginTopStyle,10);marginBottomPx=parseInt(marginBottomStyle,10);value=(marginTopPx==marginBottomPx)&&marginTopPx;isNaN(parseInt(value,10))&&(value=element.getAttribute("vspace"));this.setValue(value)}},commit:function(type,element,internalCommit){var value=parseInt(this.getValue(),10);if(type==IMAGE||type==PREVIEW){if(!isNaN(value)){element.setStyle("margin-top",CKEDITOR.tools.cssLength(value));element.setStyle("margin-bottom",CKEDITOR.tools.cssLength(value))}else{if(!value&&this.isChanged()){element.removeStyle("margin-top");element.removeStyle("margin-bottom")}}if(!internalCommit&&type==IMAGE){element.removeAttribute("vspace")}}else{if(type==CLEANUP){element.removeAttribute("vspace");element.removeStyle("margin-top");element.removeStyle("margin-bottom")}}}}]}]}]},{type:"vbox",children:[{type:"html",id:"htmlPreview",style:"width:100%;float:left;",html:'<div><div id="'+imagePreviewLoaderId+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+previewLinkId+'"><img id="'+previewImageId+'" alt="" /></a></td></tr></table></div></div>'}]}]}]},{id:"Upload",label:editor.lang.image.upload,elements:[{type:"html",id:"uploadHtmlPreview",html:'<div id="uploadIframe" style="height:290px;"><iframe src="'+domain+'/file/salesEdgeUploader" style="height:100%;width:100%;"></iframe></div>',onShow:function(data){jQuery("#uploadIframe iframe").attr("src",domain+"/file/salesEdgeUploader")}},{id:"dummy",type:"text",hidden:true}]},{id:"Link",requiredContent:"a[href]",label:editor.lang.image.linkTab,hidden:true,padding:0,elements:[{id:"txtUrl",type:"text",label:editor.lang.common.url,style:"width: 100%","default":"",setup:function(type,element){if(type==LINK){var href=element.data("cke-saved-href");if(!href){href=element.getAttribute("href")}this.setValue(href)}},commit:function(type,element){if(type==LINK){if(this.getValue()||this.isChanged()){var url=decodeURI(this.getValue());element.data("cke-saved-href",url);element.setAttribute("href",url);if(this.getValue()||!editor.config.image_removeLinkByEmptyURL){this.getDialog().addLink=true}}}}},{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:editor.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:true,label:editor.lang.common.browseServer},{id:"cmbTarget",type:"select",requiredContent:"a[target]",label:editor.lang.common.target,"default":"",items:[[editor.lang.common.notSet,""],[editor.lang.common.targetNew,"_blank"],[editor.lang.common.targetTop,"_top"],[editor.lang.common.targetSelf,"_self"],[editor.lang.common.targetParent,"_parent"]],setup:function(type,element){if(type==LINK){this.setValue(element.getAttribute("target")||"")}},commit:function(type,element){if(type==LINK){if(this.getValue()||this.isChanged()){element.setAttribute("target",this.getValue())}}}}]},{id:"advanced",label:editor.lang.common.advancedTab,elements:[{type:"hbox",widths:["50%","50%"],children:[{type:"text",id:"linkId",requiredContent:"img[id]",label:editor.lang.common.id,setup:function(type,element){if(type==IMAGE){this.setValue(element.getAttribute("id"))}},commit:function(type,element){if(type==IMAGE){if(this.getValue()||this.isChanged()){element.setAttribute("id",this.getValue())}}}},{type:"text",id:"txtGenClass",requiredContent:"img(cke-xyz)",label:editor.lang.common.cssClass,"default":"",setup:function(type,element){if(type==IMAGE){this.setValue(element.getAttribute("class"))}},commit:function(type,element){if(type==IMAGE){if(this.getValue()||this.isChanged()){element.setAttribute("class",this.getValue())}}}}]},{type:"text",id:"txtGenTitle",requiredContent:"img[title]",label:editor.lang.common.advisoryTitle,"default":"",onChange:function(){updatePreview(this.getDialog())},setup:function(type,element){if(type==IMAGE){this.setValue(element.getAttribute("title"))}},commit:function(type,element){if(type==IMAGE){if(this.getValue()||this.isChanged()){element.setAttribute("title",this.getValue())}}else{if(type==PREVIEW){element.setAttribute("title",this.getValue())}else{if(type==CLEANUP){element.removeAttribute("title")}}}}},{type:"text",id:"txtdlgGenStyle",requiredContent:"img{cke-xyz}",label:editor.lang.common.cssStyle,validate:CKEDITOR.dialog.validate.inlineStyle(editor.lang.common.invalidInlineStyle),"default":"",setup:function(type,element){if(type==IMAGE){var genStyle=element.getAttribute("style");if(!genStyle&&element.$.style.cssText){genStyle=element.$.style.cssText}this.setValue(genStyle);var height=element.$.style.height,width=element.$.style.width,aMatchH=(height?height:"").match(regexGetSize),aMatchW=(width?width:"").match(regexGetSize);this.attributesInStyle={height:!!aMatchH,width:!!aMatchW}}},onChange:function(){commitInternally.call(this,["info:cmbFloat","info:cmbAlign","info:txtVSpace","info:txtHSpace","info:txtBorder","info:txtWidth","info:txtHeight"]);updatePreview(this)},commit:function(type,element){if(type==IMAGE&&(this.getValue()||this.isChanged())){element.setAttribute("style",this.getValue())}}}]}]}};CKEDITOR.dialog.add("image",function(editor){return imageDialog(editor,"image")});CKEDITOR.dialog.add("imagebutton",function(editor){return imageDialog(editor,"imagebutton")})})();